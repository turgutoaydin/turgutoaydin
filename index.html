<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>Köy 3D - Basit Demo</title>
  <style>
    body { margin:0; overflow:hidden; background:#000; touch-action: none; }
    canvas { display:block; }
    #ui {
      position: absolute;
      top: 20px; left: 20px;
      color: white;
      background: rgba(0,0,0,0.6);
      padding: 12px 18px;
      border-radius: 12px;
      font-size: 16px;
      pointer-events: none;
      z-index: 10;
    }
    #info {
      position: absolute;
      bottom: 30px; left: 50%;
      transform: translateX(-50%);
      color: #fff;
      font-size: 15px;
      text-shadow: 0 2px 6px #000;
      pointer-events: none;
      z-index: 10;
    }
  </style>
</head>
<body>

<div id="ui">Köy Merkezi Demo<br>Sürükle: döndür • Çift parmak: zoom</div>
<div id="info">My Village – Köyüm büyüyor...</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.168.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.168.0/examples/js/controls/OrbitControls.min.js"></script>

<script>
console.log("Three.js demo başladı – eğer siyahsa konsola bak");

const scene = new THREE.Scene();
scene.background = new THREE.Color(0x7ec0ee);  // açık mavi gök

const camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.1, 1000);
camera.position.set(0, 10, 25);

const renderer = new THREE.WebGLRenderer({ 
  antialias: false,                // performans için kapattım
  powerPreference: "low-power",    // iOS/Safari için önemli
  alpha: false
});
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setPixelRatio(1);         // ← kritik: yüksek ratio siyah ekran yapar
document.body.appendChild(renderer.domElement);

const controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;
controls.dampingFactor = 0.1;
controls.rotateSpeed = 0.8;
controls.zoomSpeed = 1.2;
controls.minDistance = 10;
controls.maxDistance = 60;
controls.maxPolarAngle = Math.PI * 0.5;
controls.enablePan = false;
controls.target.set(0, 0, 0);

// Işık – basit tutalım
const ambient = new THREE.AmbientLight(0xffffff, 0.9);
scene.add(ambient);

const dirLight = new THREE.DirectionalLight(0xffffff, 0.8);
dirLight.position.set(20, 40, 30);
scene.add(dirLight);

// Düz arazi (engebe yok, sorun çıkmasın)
const groundGeo = new THREE.PlaneGeometry(100, 100);
const groundMat = new THREE.MeshBasicMaterial({ color: 0x88aa55 });  // yeşil çimen
const ground = new THREE.Mesh(groundGeo, groundMat);
ground.rotation.x = -Math.PI / 2;
scene.add(ground);

// Basit ev fonksiyonu (shadow yok)
function addHouse(x, z, color = 0xff6666) {
  const group = new THREE.Group();

  // taban
  const base = new THREE.Mesh(
    new THREE.BoxGeometry(6, 0.5, 7),
    new THREE.MeshBasicMaterial({ color: 0xdddddd })
  );
  base.position.y = 0.25;
  group.add(base);

  // duvar
  const walls = new THREE.Mesh(
    new THREE.BoxGeometry(5.5, 4, 6.5),
    new THREE.MeshBasicMaterial({ color })
  );
  walls.position.y = 2.25;
  group.add(walls);

  // çatı
  const roof = new THREE.Mesh(
    new THREE.ConeGeometry(5, 4, 4),
    new THREE.MeshBasicMaterial({ color: 0xaa0000 })
  );
  roof.position.y = 4.5;
  roof.rotation.y = Math.PI / 4;
  group.add(roof);

  group.position.set(x, 0, z);
  scene.add(group);
}

// Ağaç basit
function addTree(x, z) {
  const group = new THREE.Group();

  const trunk = new THREE.Mesh(
    new THREE.CylinderGeometry(0.8, 1.2, 5, 6),
    new THREE.MeshBasicMaterial({ color: 0x8b4513 })
  );
  trunk.position.y = 2.5;
  group.add(trunk);

  const leaves = new THREE.Mesh(
    new THREE.ConeGeometry(4, 7, 6),
    new THREE.MeshBasicMaterial({ color: 0x228b22 })
  );
  leaves.position.y = 6;
  group.add(leaves);

  group.position.set(x, 0, z);
  scene.add(group);
}

// Yerleştir
addHouse(-8, -5, 0xff7777);
addHouse(6, -7, 0x7799ff);
addHouse(10, 4, 0xffcc66);

addTree(-12, 8);
addTree(14, -10);
addTree(0, 12);

// Animate
function animate() {
  requestAnimationFrame(animate);
  controls.update();
  renderer.render(scene, camera);
}
animate();

// Resize
window.addEventListener('resize', () => {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});

console.log("Sahne yüklendi – nesneler eklendi. Renderer aktif.");
</script>
</body>
</html>