<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>Sihirbaz SatrancÄ± âš¡â™Ÿ</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root {
      --dark-stone: #1a1a2e;
      --light-stone: #e0c9a6;
      --accent: #d4af37;
      --glow: rgba(212, 175, 55, 0.7);
    }

    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: 'Segoe UI', system-ui, sans-serif;
      background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
      color: #f0e8d0;
      overflow: hidden;
    }

    #root {
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      background: rgba(0,0,0,0.6);
      padding: 12px;
      text-align: center;
      border-bottom: 1px solid #d4af3744;
      backdrop-filter: blur(6px);
    }

    h1 {
      margin: 0;
      font-size: 1.5rem;
      color: var(--accent);
      text-shadow: 0 0 10px var(--glow);
    }

    .status {
      font-size: 0.9rem;
      margin-top: 4px;
      opacity: 0.9;
    }

    #board {
      flex: 1;
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      grid-template-rows: repeat(8, 1fr);
      gap: 2px;
      padding: 10px;
      max-width: 100%;
      aspect-ratio: 1 / 1;
      margin: 0 auto;
      background: radial-gradient(circle at 30% 30%, #3a2a5f, #0f0c29);
      border: 8px solid #4a3728;
      border-radius: 12px;
      box-shadow: 
        0 0 30px rgba(212,175,55,0.25),
        inset 0 0 60px rgba(0,0,0,0.7);
      position: relative;
      overflow: hidden;
    }

    .board::before {
      content: "";
      position: absolute;
      inset: 0;
      background: url('https://images.unsplash.com/photo-1617791160505-6f00504e3519?w=800&q=10') center/cover;
      opacity: 0.07;
      pointer-events: none;
    }

    .square {
      position: relative;
      background: var(--dark-stone);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.4rem;
      cursor: pointer;
      transition: all 0.25s;
      box-shadow: inset 0 0 8px rgba(0,0,0,0.6);
    }

    .square.light {
      background: var(--light-stone);
    }

    .piece {
      transition: transform 0.6s cubic-bezier(0.22, 0.61, 0.36, 1);
      text-shadow: 0 0 10px black;
      filter: drop-shadow(0 4px 6px black);
      user-select: none;
    }

    .piece.white { color: #f8f0d8; }
    .piece.black { color: #2d1b12; }

    /* Sihirli hareket animasyonu */
    @keyframes magic-move {
      0%   { transform: translate(0,0) scale(1); }
      30%  { transform: translateY(-20px) scale(1.15); text-shadow: 0 0 20px var(--glow); }
      70%  { transform: translateY(-8px) scale(1.08); }
      100% { transform: translate(0,0) scale(1); }
    }

    .moving {
      animation: magic-move 0.8s ease-out forwards;
      z-index: 10;
    }

    /* YendiÄŸinde parÃ§alanma efekti */
    @keyframes destroy {
      0%   { transform: scale(1) rotate(0deg); opacity: 1; }
      40%  { transform: scale(1.4) rotate(15deg); opacity: 0.9; }
      100% { transform: scale(0.2) rotate(180deg); opacity: 0; }
    }

    .destroyed {
      animation: destroy 0.7s forwards;
      pointer-events: none;
    }

    .selected {
      box-shadow: 0 0 0 4px var(--accent), inset 0 0 12px var(--glow);
      background: rgba(212,175,55,0.15) !important;
    }

    .possible {
      background: rgba(100,200,100,0.35) !important;
      box-shadow: 0 0 12px rgba(100,255,100,0.6);
    }

    #info {
      padding: 12px;
      background: rgba(0,0,0,0.5);
      text-align: center;
      font-size: 0.95rem;
      border-top: 1px solid #d4af3744;
    }

    button {
      margin: 8px 12px;
      padding: 10px 20px;
      font-size: 1rem;
      background: #4a3728;
      color: var(--accent);
      border: 2px solid var(--accent);
      border-radius: 8px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<div id="root">
  <header>
    <h1>âš¡ Sihirbaz SatrancÄ± â™Ÿ</h1>
    <div class="status" id="status">Beyaz baÅŸlar â€” Sen beyazsÄ±n</div>
  </header>

  <div id="board"></div>

  <div id="info">
    <div id="message">TaÅŸ seÃ§mek iÃ§in bir taÅŸÄ±na dokun</div>
    <button onclick="resetGame()">Yeni Oyun BaÅŸlat</button>
  </div>
</div>

<script>
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//   Basit Sihirbaz SatrancÄ± â€“ Telegram Mini App Demo
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const boardEl = document.getElementById('board');
const statusEl = document.getElementById('status');
const messageEl = document.getElementById('message');

let selectedPiece = null;
let currentPlayer = 'w'; // w / b
let board = [];

const pieces = {
  'K': 'â™”', 'Q': 'â™•', 'R': 'â™–', 'B': 'â™—', 'N': 'â™˜', 'P': 'â™™',
  'k': 'â™š', 'q': 'â™›', 'r': 'â™œ', 'b': 'â™', 'n': 'â™', 'p': 'â™Ÿ'
};

function createBoard() {
  board = [
    'rnbqkbnr'.split(''),
    'pppppppp'.split(''),
    Array(8).fill(null),
    Array(8).fill(null),
    Array(8).fill(null),
    Array(8).fill(null),
    'PPPPPPPP'.split(''),
    'RNBQKBNR'.split('')
  ];

  renderBoard();
  updateStatus();
}

function renderBoard() {
  boardEl.innerHTML = '';

  for (let r = 0; r < 8; r++) {
    for (let c = 0; c < 8; c++) {
      const square = document.createElement('div');
      square.classList.add('square');
      if ((r + c) % 2 === 1) square.classList.add('light');

      square.dataset.row = r;
      square.dataset.col = c;

      const p = board[r][c];
      if (p) {
        const piece = document.createElement('div');
        piece.classList.add('piece', p === p.toUpperCase() ? 'white' : 'black');
        piece.textContent = pieces[p];
        piece.dataset.piece = p;
        square.appendChild(piece);
      }

      square.addEventListener('click', onSquareClick);
      boardEl.appendChild(square);
    }
  }
}

function onSquareClick(e) {
  const square = e.currentTarget;
  const r = +square.dataset.row;
  const c = +square.dataset.col;
  const piece = board[r][c];

  if (selectedPiece) {
    // Hareket denemesi
    if (isValidMove(selectedPiece.r, selectedPiece.c, r, c)) {
      movePiece(selectedPiece.r, selectedPiece.c, r, c);
      selectedPiece = null;
      clearHighlights();
      switchPlayer();
    } else {
      clearHighlights();
      selectedPiece = null;
      messageEl.textContent = "GeÃ§ersiz hamle!";
    }
  } else if (piece && ((currentPlayer === 'w' && piece === piece.toUpperCase()) || 
                        (currentPlayer === 'b' && piece === piece.toLowerCase()))) {
    // TaÅŸ seÃ§me
    selectedPiece = { r, c };
    highlightSelected(r, c);
    messageEl.textContent = "Nereye gÃ¶tÃ¼receksin?";
  }
}

function highlightSelected(r, c) {
  const squares = boardEl.querySelectorAll('.square');
  squares.forEach(sq => {
    const sr = +sq.dataset.row, sc = +sq.dataset.col;
    if (sr === r && sc === c) sq.classList.add('selected');
    // GerÃ§ek oyunda burada possible moves gÃ¶sterilir (ÅŸimdilik basitÃ§e seÃ§ili gÃ¶steriyoruz)
  });
}

function clearHighlights() {
  document.querySelectorAll('.selected, .possible').forEach(el => {
    el.classList.remove('selected', 'possible');
  });
}

function movePiece(fromR, fromC, toR, toC) {
  const piece = board[fromR][fromC];
  const captured = board[toR][toC];

  board[toR][toC] = piece;
  board[fromR][fromC] = null;

  renderBoard();

  // Animasyon tetikleme
  const fromSquare = getSquare(fromR, fromC);
  const toSquare = getSquare(toR, toC);

  if (fromSquare && toSquare) {
    const pieceEl = fromSquare.querySelector('.piece');
    if (pieceEl) {
      pieceEl.classList.add('moving');
      setTimeout(() => pieceEl.classList.remove('moving'), 900);
    }
  }

  if (captured) {
    const capturedEl = toSquare.querySelector('.piece');
    if (capturedEl) {
      capturedEl.classList.add('destroyed');
      setTimeout(() => capturedEl.remove(), 800);
    }
    messageEl.textContent = `BAM! ${captured.toUpperCase()} yok edildi!`;
  } else {
    messageEl.textContent = "Sihirli bir hamle!";
  }
}

function getSquare(r, c) {
  return boardEl.querySelector(`[data-row="${r}"][data-col="${c}"]`);
}

function isValidMove(fromR, fromC, toR, toC) {
  // Åimdilik Ã§ok basit (her yere gitmesine izin veriyoruz)
  // GerÃ§ek satranÃ§ kurallarÄ± iÃ§in chess.js kÃ¼tÃ¼phanesi eklenebilir
  return true; // â† DEMO iÃ§in her hamleye izin
  // Ä°leride: chess.js ile kontrol â†’ https://github.com/jhlywa/chess.js
}

function switchPlayer() {
  currentPlayer = currentPlayer === 'w' ? 'b' : 'w';
  updateStatus();
}

function updateStatus() {
  statusEl.textContent = currentPlayer === 'w' 
    ? "BeyazlarÄ±n sÄ±rasÄ± â€” Sen beyazsÄ±n âš¡" 
    : "SiyahlarÄ±n sÄ±rasÄ± â€” KaranlÄ±k gÃ¼Ã§ler oynuyor ğŸ–¤";
}

function resetGame() {
  currentPlayer = 'w';
  selectedPiece = null;
  createBoard();
  messageEl.textContent = "Yeni oyun baÅŸladÄ±! Beyaz baÅŸlar.";
}

// BaÅŸlat
createBoard();

// Telegram Mini App hazÄ±r olunca tema vs. alabilirsin
window.Telegram?.WebApp?.ready();
window.Telegram?.WebApp?.expand();

</script>
</body>
</html>