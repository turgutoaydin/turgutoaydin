<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>My Village - Ana Ekran Demo</title>
  <style>
    body { margin:0; overflow:hidden; background:#000; touch-action:none; }
    canvas { display:block; width:100%; height:100%; }
    #overlay {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      pointer-events: none;
      color: white;
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 20px;
      box-sizing: border-box;
      z-index: 10;
    }
    #title { font-size: 24px; text-shadow: 0 2px 8px black; }
    #status { font-size: 16px; text-shadow: 0 1px 4px black; }
  </style>
</head>
<body>

<div id="overlay">
  <div id="title">My Village</div>
  <div id="status">Köy merkezi yükleniyor... Parmakla döndür • Çift parmakla zoom yap</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.168.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.168.0/examples/js/controls/OrbitControls.min.js"></script>

<script>
  console.log("Demo başladı - Three.js versiyon:", THREE.REVISION);

  const scene = new THREE.Scene();
  scene.background = new THREE.Color(0x88ddff); // açık mavi gökyüzü

  const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
  camera.position.set(0, 12, 30);
  camera.lookAt(0, 0, 0);

  const renderer = new THREE.WebGLRenderer({ antialias: false });
  renderer.setSize(window.innerWidth, window.innerHeight);
  renderer.setPixelRatio(1); // mobil siyah ekran fix #1
  document.body.appendChild(renderer.domElement);

  const controls = new THREE.OrbitControls(camera, renderer.domElement);
  controls.enableDamping = true;
  controls.dampingFactor = 0.12;
  controls.rotateSpeed = 0.7;
  controls.zoomSpeed = 1.1;
  controls.minDistance = 12;
  controls.maxDistance = 80;
  controls.maxPolarAngle = Math.PI * 0.5;
  controls.enablePan = false;
  controls.target.set(0, 2, 0);

  // Basit ışık
  scene.add(new THREE.AmbientLight(0xffffff, 1.0));

  // Düz zemin
  const ground = new THREE.Mesh(
    new THREE.PlaneGeometry(120, 120),
    new THREE.MeshBasicMaterial({ color: 0x7caf5e }) // yeşil çimen
  );
  ground.rotation.x = -Math.PI / 2;
  scene.add(ground);

  // Ev ekleme fonksiyonu (çok basit, shadow yok)
  function evEkle(x, z, renk = 0xff5555) {
    const grup = new THREE.Group();

    // Taban
    const taban = new THREE.Mesh(
      new THREE.BoxGeometry(8, 1, 9),
      new THREE.MeshBasicMaterial({ color: 0xcccccc })
    );
    taban.position.y = 0.5;
    grup.add(taban);

    // Duvar
    const duvar = new THREE.Mesh(
      new THREE.BoxGeometry(7, 6, 8),
      new THREE.MeshBasicMaterial({ color: renk })
    );
    duvar.position.y = 3.5;
    grup.add(duvar);

    // Çatı
    const cati = new THREE.Mesh(
      new THREE.ConeGeometry(7, 5, 4),
      new THREE.MeshBasicMaterial({ color: 0x880000 })
    );
    cati.position.y = 7;
    cati.rotation.y = Math.PI / 4;
    grup.add(cati);

    grup.position.set(x, 0, z);
    scene.add(grup);
    console.log("Ev eklendi:", x, z);
  }

  // Ağaç
  function agacEkle(x, z) {
    const grup = new THREE.Group();

    const govde = new THREE.Mesh(
      new THREE.CylinderGeometry(1.2, 1.8, 7, 6),
      new THREE.MeshBasicMaterial({ color: 0x8b4513 })
    );
    govde.position.y = 3.5;
    grup.add(govde);

    const yaprak = new THREE.Mesh(
      new THREE.ConeGeometry(6, 10, 6),
      new THREE.MeshBasicMaterial({ color: 0x228b22 })
    );
    yaprak.position.y = 9;
    grup.add(yaprak);

    grup.position.set(x, 0, z);
    scene.add(grup);
    console.log("Ağaç eklendi:", x, z);
  }

  // Köyü kur
  evEkle(-12, -8, 0xff7777);
  evEkle(10, -10, 0x7777ff);
  evEkle(15, 6, 0xffaa55);

  agacEkle(-18, 12);
  agacEkle(20, -15);
  agacEkle(-5, 18);

  // Küçük gölet
  const golet = new THREE.Mesh(
    new THREE.CircleGeometry(9, 24),
    new THREE.MeshBasicMaterial({ color: 0x4488ff })
  );
  golet.rotation.x = -Math.PI / 2;
  golet.position.set(-4, 0.05, 14);
  scene.add(golet);

  console.log("Tüm nesneler sahneye eklendi - animate başlıyor");

  function animate() {
    requestAnimationFrame(animate);
    controls.update();
    renderer.render(scene, camera);
  }
  animate();

  // Resize
  window.addEventListener('resize', () => {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
  });

  // Status güncelle
  document.getElementById('status').innerText = "Köy hazır! Köyümü büyütmeye başla...";
</script>
</body>
</html>