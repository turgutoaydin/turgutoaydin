<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>My Village ‚Ä¢ Harita</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      width: 100%;
      height: 100%;
      overflow: hidden;
      font-family: system-ui, -apple-system, sans-serif;
      background: #0f1e0f;
      color: #f0e8d0;
      touch-action: none;           /* mobil kaydƒ±rma daha d√ºzg√ºn */
    }

    #app {
      height: 100dvh;
      display: grid;
      grid-template-rows: auto 1fr auto;
      background: radial-gradient(circle at 30% 70%, #1e3a1e, #0d1a0d);
    }

    header {
      background: linear-gradient(to bottom, #2a3f2a, #1a2a1a);
      padding: 12px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 2px solid #4a6c3f77;
      box-shadow: 0 3px 12px #0008;
      z-index: 30;
    }

    h1 {
      font-size: 1.5rem;
      font-weight: 800;
      letter-spacing: 1.5px;
      background: linear-gradient(90deg, #e8d5a3, #f0e0b8);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .tool-bar {
      position: relative;
      z-index: 20;
      background: rgba(20, 30, 18, 0.88);
      backdrop-filter: blur(10px);
      border-top: 1px solid #4a6c3f66;
      padding: 10px 12px;
      overflow-x: auto;
      white-space: nowrap;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }

    .tool-bar::-webkit-scrollbar { display: none; }

    .tool-item {
      display: inline-flex;
      flex-direction: column;
      align-items: center;
      margin: 0 10px;
      padding: 8px 12px;
      border-radius: 16px;
      background: rgba(60, 80, 50, 0.4);
      border: 1px solid #5a7a4f44;
      color: #e8dab0;
      font-size: 0.72rem;
      font-weight: 600;
      min-width: 68px;
      transition: all 0.12s;
      user-select: none;
    }

    .tool-item:active {
      transform: scale(0.94);
      background: rgba(90, 110, 80, 0.7);
      border-color: #8aa66f;
    }

    .tool-emoji {
      font-size: 1.9rem;
      margin-bottom: 4px;
      filter: drop-shadow(0 2px 4px #0006);
    }

    .map-container {
      position: relative;
      overflow: hidden;
      background: #1e3320;
    }

    canvas {
      display: block;
      width: 100%;
      height: 100%;
      touch-action: none;
    }

    .hud-bottom-left {
      position: absolute;
      bottom: 90px;
      left: 12px;
      background: rgba(10, 18, 10, 0.82);
      backdrop-filter: blur(8px);
      padding: 8px 14px;
      border-radius: 30px;
      font-size: 0.82rem;
      border: 1px solid #5a7a4f66;
      box-shadow: 0 3px 12px #0007;
      pointer-events: none;
      z-index: 15;
    }

    .fab-container {
      position: absolute;
      bottom: 110px;
      right: 16px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      z-index: 25;
    }

    .fab {
      width: 58px;
      height: 58px;
      border-radius: 50%;
      background: linear-gradient(145deg, #4a6c3f, #2e4a28);
      border: 2px solid #8aa66f;
      color: #f0e8c0;
      font-size: 1.8rem;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 5px 0 #1e2f18, 0 8px 16px #0008;
      transition: all 0.1s;
    }

    .fab:active {
      transform: translateY(3px);
      box-shadow: 0 2px 0 #1e2f18, 0 8px 16px #0006;
    }

    @media (orientation: landscape) {
      .tool-bar {
        padding: 6px 10px;
      }
      .tool-item {
        min-width: 60px;
        margin: 0 6px;
      }
      .tool-emoji { font-size: 1.7rem; }
    }
  </style>
</head>
<body>

<div id="app">
  <header>
    <h1>ü™¥ MY VILLAGE</h1>
    <div>üåæ</div>
  </header>

  <div class="map-container">
    <canvas id="c"></canvas>
    <div class="hud-bottom-left" id="info">Zoom: 100% ‚Ä¢ Kaydƒ±r</div>
  </div>

  <div class="tool-bar" id="tools"></div>

  <div class="fab-container">
    <div class="fab" id="zoomIn">+</div>
    <div class="fab" id="zoomOut">‚àí</div>
    <div class="fab" id="home">‚ü≤</div>
  </div>
</div>

<script>
const canvas = document.getElementById('c');
const ctx    = canvas.getContext('2d');
const info   = document.getElementById('info');

// ----------------------- KONFIG -----------------------
const WORLD_W = 2400;
const WORLD_H = 2400;

let camX = 600;
let camY = 800;
let zoom = 0.70;

const MIN_ZOOM = 0.4;
const MAX_ZOOM = 2.4;

// ----------------------- ƒ∞√áERƒ∞K -----------------------
const items = [
  {emoji:'üèõÔ∏è',  label:'K√∂y Merkezi',   x:780,  y:620, size:48, color:'#e8b923'},
  {emoji:'üè°',   label:'Halk Evi',      x:480,  y:980, size:36, color:'#c89f6e'},
  {emoji:'üè†',   label:'Yeni Ev',       x:620,  y:1100,size:36, color:'#c89f6e'},
  {emoji:'üåΩ',   label:'Mƒ±sƒ±r Tarlasƒ±', x:320,  y:480, size:44, color:'#6b8e23'},
  {emoji:'üåæ',   label:'Buƒüday',        x:1400, y:720, size:44, color:'#d4a017'},
  {emoji:'‚ö°',    label:'G√ºne≈ü Paneli',  x:1680, y:480, size:40, color:'#ffdd33'},
  {emoji:'‚õèÔ∏è',   label:'Maden',         x:1320, y:1480,size:44, color:'#7a4a2e'},
  {emoji:'üêÑ',   label:'√áiftlik',       x:1580, y:340, size:48, color:'#b86f2e'},
  {emoji:'üíß',   label:'Su Kuyusu',     x:420,  y:280, size:40, color:'#3a8da8'},
  {emoji:'üå≥',   label:'Me≈üe',          x:900,  y:200, size:52, color:'#2e6b3e'},
  {emoji:'üå≤',   label:'√áam',           x:200,  y:1600,size:48, color:'#385f2e'},
];

const roads = [
  {x1:300,y1:600, x2:1100,y2:600, w:28, c:'#6d4c3a'},
  {x1:700,y1:400, x2:700,y2:1200,w:24, c:'#8b6a4a'},
  {x1:1200,y1:300,x2:1800,y2:300,w:26, c:'#7a5a3e'},
];

// ----------------------- √áƒ∞Zƒ∞M -----------------------
function resize() {
  canvas.width  = window.innerWidth;
  canvas.height = window.innerHeight - 140; // header + toolbar yakla≈üƒ±k
  draw();
}

function worldToScreen(wx, wy) {
  return {
    x: (wx - camX) * zoom + canvas.width/2,
    y: (wy - camY) * zoom + canvas.height/2
  };
}

function draw() {
  ctx.fillStyle = '#1e3a1e';
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // hafif √ßim doku
  ctx.fillStyle = '#2a4a2a';
  for (let i = -canvas.width; i < canvas.width*2; i += 80) {
    for (let j = -canvas.height; j < canvas.height*2; j += 80) {
      if ((i+j) % 160 < 80) {
        ctx.globalAlpha = 0.4;
        ctx.fillRect(i,j,40,40);
      }
    }
  }
  ctx.globalAlpha = 1;

  ctx.save();
  ctx.translate(canvas.width/2, canvas.height/2);
  ctx.scale(zoom, zoom);
  ctx.translate(-camX, -camY);

  // yollar
  roads.forEach(r => {
    ctx.lineWidth = r.w;
    ctx.lineCap = 'round';
    ctx.strokeStyle = r.c;
    ctx.beginPath();
    ctx.moveTo(r.x1, r.y1);
    ctx.lineTo(r.x2, r.y2);
    ctx.stroke();
  });

  // √∂ƒüeler
  items.forEach(it => {
    const s = it.size || 36;
    ctx.font = `bold ${s}px system-ui, sans-serif`;
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.shadowColor = 'black';
    ctx.shadowBlur = 6;
    ctx.fillStyle = it.color || '#f0e8d0';
    ctx.fillText(it.emoji, it.x, it.y);

    // etiket (sadece yakƒ±nken g√∂sterilebilir ama ≈üimdilik hep)
    ctx.font = `600 ${18}px system-ui`;
    ctx.fillStyle = 'rgba(0,0,0,0.6)';
    ctx.fillRect(it.x - 60, it.y + 22, 120, 28);
    ctx.fillStyle = '#f8e9c0';
    ctx.fillText(it.label, it.x, it.y + 36);
  });

  ctx.restore();

  // HUD g√ºncelle
  info.textContent = `Zoom: ${Math.round(zoom*100)}% ‚Ä¢ Kaydƒ±r`;
}

// ----------------------- KONTROLLER -----------------------
let isDragging = false;
let startX, startY, startCamX, startCamY;

function pointerDown(e) {
  isDragging = true;
  const p = e.touches ? e.touches[0] : e;
  startX = p.clientX;
  startY = p.clientY;
  startCamX = camX;
  startCamY = camY;
}

function pointerMove(e) {
  if (!isDragging) return;
  e.preventDefault();
  const p = e.touches ? e.touches[0] : e;
  const dx = (p.clientX - startX) / zoom;
  const dy = (p.clientY - startY) / zoom;
  camX = startCamX - dx;
  camY = startCamY - dy;
  clampCamera();
  draw();
}

function pointerUp() {
  isDragging = false;
}

function clampCamera() {
  const viewW = canvas.width  / zoom;
  const viewH = canvas.height / zoom;
  camX = Math.max(viewW/2, Math.min(camX, WORLD_W - viewW/2));
  camY = Math.max(viewH/2, Math.min(camY, WORLD_H - viewH/2));
}

function zoomAt(delta, mx, my) {
  const wx = camX + (mx - canvas.width/2)  / zoom;
  const wy = camY + (my - canvas.height/2) / zoom;
  zoom *= (1 + delta);
  zoom = Math.max(MIN_ZOOM, Math.min(MAX_ZOOM, zoom));
  camX = wx - (mx - canvas.width/2)  / zoom;
  camY = wy - (my - canvas.height/2) / zoom;
  clampCamera();
  draw();
}

canvas.addEventListener('pointerdown', pointerDown);
window.addEventListener('pointermove', pointerMove);
window.addEventListener('pointerup',   pointerUp);
window.addEventListener('pointercancel', pointerUp);

// wheel (mouse) ve pinch (mobil) i√ßin
canvas.addEventListener('wheel', e => {
  e.preventDefault();
  const delta = -Math.sign(e.deltaY) * 0.12;
  zoomAt(delta, e.offsetX, e.offsetY);
}, {passive:false});

// pinch zoom (mobil)
let prevDist = 0;
canvas.addEventListener('touchmove', e => {
  if (e.touches.length === 2) {
    e.preventDefault();
    const t1 = e.touches[0], t2 = e.touches[1];
    const dist = Math.hypot(
      t1.clientX - t2.clientX,
      t1.clientY - t2.clientY
    );
    if (prevDist > 0) {
      const delta = (dist - prevDist) / 800;
      const mx = (t1.clientX + t2.clientX)/2;
      const my = (t1.clientY + t2.clientY)/2;
      zoomAt(delta * 2, mx, my);
    }
    prevDist = dist;
  }
}, {passive:false});

canvas.addEventListener('touchend', () => prevDist = 0);

// butonlar
document.getElementById('zoomIn').onclick  = () => zoomAt(0.18, canvas.width/2, canvas.height/2);
document.getElementById('zoomOut').onclick = () => zoomAt(-0.18, canvas.width/2, canvas.height/2);
document.getElementById('home').onclick    = () => { zoom=0.7; camX=600; camY=800; draw(); };

// tool-bar olu≈ütur
const toolsDiv = document.getElementById('tools');
items.slice(0,8).forEach(it => {   // ilk 8 taneyi g√∂sterelim
  const el = document.createElement('div');
  el.className = 'tool-item';
  el.innerHTML = `<span class="tool-emoji">${it.emoji}</span>${it.label.split(' ')[0]}`;
  el.onclick = () => {
    camX = it.x;
    camY = it.y;
    zoom = 1.4;
    clampCamera();
    draw();
  };
  toolsDiv.appendChild(el);
});

// ba≈ülangƒ±√ß
window.addEventListener('resize', resize);
resize();
draw();
</script>
</body>
</html>