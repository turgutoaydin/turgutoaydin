<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>KÃ¶y Merkezi â€“ 3D Demo</title>

<style>
  html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: radial-gradient(circle at top, #1a3d2f, #08150f);
    touch-action: none;
    font-family: system-ui, sans-serif;
    color: #fff;
  }

  canvas {
    display: block;
  }

  /* UI */
  .ui {
    position: fixed;
    inset: 0;
    pointer-events: none;
  }

  .top {
    position: absolute;
    top: 12px;
    left: 12px;
    right: 12px;
    background: rgba(255,255,255,.08);
    backdrop-filter: blur(12px);
    border-radius: 14px;
    padding: 10px 14px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    pointer-events: auto;
  }

  .bottom {
    position: absolute;
    bottom: 18px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 10px;
    pointer-events: auto;
  }

  .btn {
    background: linear-gradient(180deg,#facc15,#eab308);
    color: #111;
    font-weight: 700;
    padding: 12px 16px;
    border-radius: 14px;
    border: none;
    box-shadow:
      inset 0 -4px 0 rgba(0,0,0,.3),
      0 10px 25px rgba(0,0,0,.5);
  }

  .btn:active {
    transform: translateY(3px);
    box-shadow: inset 0 -1px 0 rgba(0,0,0,.4);
  }
</style>
</head>
<body>

<canvas id="c"></canvas>

<div class="ui">
  <div class="top">
    <div>
      <div style="font-size:12px;opacity:.7">ğŸ° KÃ¶y Merkezi</div>
      <strong>Seviye 7</strong>
    </div>
    <div style="font-size:12px">ğŸ˜Š Halk %82</div>
  </div>

  <div class="bottom">
    <button class="btn">ğŸ‘¥ Halk</button>
    <button class="btn">ğŸ’° YatÄ±rÄ±m</button>
    <button class="btn">ğŸ“Š YÃ¶netim</button>
  </div>
</div>

<script src="https://unpkg.com/three@0.158.0/build/three.min.js"></script>

<script>
/* =============================
   TARAYICI ZOOM TAM KAPALI
============================= */
document.addEventListener('gesturestart', e => e.preventDefault());
document.addEventListener('gesturechange', e => e.preventDefault());
document.addEventListener('gestureend', e => e.preventDefault());

let lastTouchEnd = 0;
document.addEventListener('touchend', e => {
  const now = Date.now();
  if (now - lastTouchEnd <= 300) e.preventDefault();
  lastTouchEnd = now;
}, false);

/* =============================
   THREE.JS SETUP
============================= */
const canvas = document.getElementById("c");
const scene = new THREE.Scene();

const camera = new THREE.PerspectiveCamera(
  45,
  window.innerWidth / window.innerHeight,
  0.1,
  100
);

// ISOMETRIC / FARMVILLE AÃ‡ISI
camera.position.set(0, 9, 16);
camera.lookAt(0, 1.5, 0);

const renderer = new THREE.WebGLRenderer({
  canvas,
  antialias: true,
  alpha: true
});
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setPixelRatio(Math.min(devicePixelRatio, 2));

/* =============================
   LIGHT
============================= */
scene.add(new THREE.AmbientLight(0xffffff, 0.7));

const sun = new THREE.DirectionalLight(0xfff2cc, 1.3);
sun.position.set(10, 15, 10);
scene.add(sun);

/* =============================
   GROUND / MAP
============================= */
const ground = new THREE.Mesh(
  new THREE.CircleGeometry(14, 64),
  new THREE.MeshStandardMaterial({ color: 0x2f6b4f })
);
ground.rotation.x = -Math.PI / 2;
scene.add(ground);

/* =============================
   VILLAGE CENTER
============================= */
const centerGroup = new THREE.Group();

const base = new THREE.Mesh(
  new THREE.CylinderGeometry(2.6, 3.2, 2.2, 6),
  new THREE.MeshStandardMaterial({ color: 0x8b5a2b })
);
base.position.y = 1.1;

const roof = new THREE.Mesh(
  new THREE.ConeGeometry(3.5, 2.2, 6),
  new THREE.MeshStandardMaterial({ color: 0xd97706 })
);
roof.position.y = 3.3;

centerGroup.add(base, roof);
scene.add(centerGroup);

/* =============================
   NPCs
============================= */
const npcs = new THREE.Group();

for (let i = 0; i < 10; i++) {
  const npc = new THREE.Mesh(
    new THREE.SphereGeometry(0.28, 16, 16),
    new THREE.MeshStandardMaterial({ color: 0xfcd34d })
  );

  const a = (i / 10) * Math.PI * 2;
  npc.position.set(Math.cos(a) * 4.5, 0.28, Math.sin(a) * 4.5);
  npcs.add(npc);
}

scene.add(npcs);

/* =============================
   AURA
============================= */
const aura = new THREE.Mesh(
  new THREE.RingGeometry(3.4, 3.8, 64),
  new THREE.MeshBasicMaterial({
    color: 0xfacc15,
    transparent: true,
    opacity: 0.6,
    side: THREE.DoubleSide
  })
);
aura.rotation.x = -Math.PI / 2;
scene.add(aura);

/* =============================
   TOUCH CONTROLS
============================= */
let isRotating = false;
let lastX = 0;

let pinchStartDist = 0;
let startCamZ = camera.position.z;

canvas.addEventListener("touchstart", e => {
  if (e.touches.length === 1) {
    isRotating = true;
    lastX = e.touches[0].clientX;
  }

  if (e.touches.length === 2) {
    pinchStartDist = Math.hypot(
      e.touches[0].clientX - e.touches[1].clientX,
      e.touches[0].clientY - e.touches[1].clientY
    );
    startCamZ = camera.position.z;
  }
});

canvas.addEventListener("touchmove", e => {
  if (e.touches.length === 1 && isRotating) {
    const dx = e.touches[0].clientX - lastX;
    scene.rotation.y += dx * 0.004;
    lastX = e.touches[0].clientX;
  }

  if (e.touches.length === 2) {
    const dist = Math.hypot(
      e.touches[0].clientX - e.touches[1].clientX,
      e.touches[0].clientY - e.touches[1].clientY
    );

    const zoom = (pinchStartDist - dist) * 0.01;
    camera.position.z = THREE.MathUtils.clamp(
      startCamZ + zoom,
      10,
      22
    );
  }
});

canvas.addEventListener("touchend", () => {
  isRotating = false;
});

/* =============================
   LOOP
============================= */
function animate() {
  requestAnimationFrame(animate);

  npcs.children.forEach((n, i) => {
    n.position.y = 0.28 + Math.sin(Date.now() * 0.002 + i) * 0.06;
  });

  aura.rotation.z += 0.01;

  renderer.render(scene, camera);
}
animate();

/* =============================
   RESIZE
============================= */
window.addEventListener("resize", () => {
  camera.aspect = innerWidth / innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth, innerHeight);
});
</script>

</body>
</html>